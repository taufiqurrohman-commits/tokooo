<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwa9Eyc8gf4StOVX3ONngd33jE7bX7tIOysUwlO145ciG46gHyr0b0VBSnJj52nDFCf/exec";

let cart = JSON.parse(localStorage.getItem("cart")) || [];

function simpanCart() {
  localStorage.setItem("cart", JSON.stringify(cart));
}

function tambahProduk(id) {
  const produk = window.dataProduk.find(p => p.id == id);
  cart.push(produk);
  simpanCart();
  renderCart();
}

function renderCart() {
  let total = 0;
  let html = "<h3>ðŸ§º Keranjang</h3>";

  if (cart.length === 0) {
    html += "<p>Keranjang kosong</p>";
  } else {
    cart.forEach((p, i) => {
      total += Number(p.harga);
      html += `<p>${p.nama} - Rp ${p.harga}</p>`;
    });
    html += `<b>Total: Rp ${total}</b>`;
  }

  document.getElementById("cart").innerHTML = html;
}

fetch(API_URL)
  .then(res => res.json())
  .then(data => {
    window.dataProduk = data;

    let html = "";
    data.forEach(p => {
      html += `
        <div class="card">
          <h4>${p.nama}</h4>
          <p>Rp ${p.harga}</p>
          <button onclick="tambahProduk(${p.id})">
            Tambah
          </button>
        </div>
      `;
    });

    document.getElementById("produk").innerHTML = html;
    renderCart();
  });
</script>
